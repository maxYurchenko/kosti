<div class="my_games-step3">
    <h1 class="my_games-title">
        <span data-th-text="${day.displayName}"></span>
        <span data-th-text="${day.dayName + ', '}"></span>
        <span data-th-text="${day.date}"></span>
        <span data-th-text="${day.monthName}"></span>
        <span class="icon-arrow"></span>
    </h1>
    <p class="my_games-caption">
        <span data-th-if="${block.time.end}"
            data-th-text="${block.time.start + ' - ' + block.time.end + ' MSK, '}"></span>
        <span data-th-unless="${block.time.end}" data-th-text="${block.time.start + ' MSK, '}"></span>
        <span data-th-text="${block.displayName + (festival.online ? '.' : ', ')}"></span>
        <span data-th-unless="${festival.online}" data-th-text="${location.displayName + '.'}"></span>
        <button class="my_games-link button js-my_games-step3-discard"
            data-th-text="${portal.localize({'_key=myGames.back', '_locale=ru'})}"></button>
    </p>
    <form action="" class="my_games-form js-my_games-form">
        <h3 class="my_games-subtitle"
            data-th-text="${portal.localize({'_key=myGames.form.gameDetails', '_locale=ru'})}"></h3>
        <div class="form-group">
            <label for="my_games_name"
                data-th-text="${portal.localize({'_key=myGames.form.name', '_locale=ru'})}"></label>
            <input
                data-th-value="${ game and game.data ? game.data.masterName : user and user.data ? user.data.firstName : '' }"
                data-th-placeholder="${portal.localize({'_key=myGames.form.name.placeholder', '_locale=ru'})}"
                type="text" name="masterName" required id="my_games_name" />
            <div class="form-caption"
                data-th-text="${portal.localize({'_key=myGames.form.name.caption', '_locale=ru'})}"></div>
        </div>
        <div class="form-group">
            <label for="my_games_name"
                data-th-text="${portal.localize({'_key=myGames.form.discord', '_locale=ru'})}"></label>
            <input data-th-value="${discord.username + ':' + discord.discriminator}"
                data-th-placeholder="${portal.localize({'_key=myGames.form.discord.placeholder', '_locale=ru'})}"
                type="text" required id="my_games_name" data-ignore="true" disabled />
        </div>
        <div class="form-group">
            <label for="my_games_system"
                data-th-text="${portal.localize({'_key=myGames.form.gameSystem', '_locale=ru'})}"></label>
            <div class="my_games-system-select select-field">
                <select required name="gameSystem" id="my_games_system"
                    class="select js-my_games-select-with-other js-my_games-system">
                    <div data-th-unless="${block and block.data && block.data.system != null}" data-th-remove="tag">
                        <option data-th-text="${portal.localize({'_key=myGames.form.gameSystem.choose', '_locale=ru'})}"
                            disabled="disabled" selected>
                        </option>
                        <option data-th-classappend="${system.class}"
                            data-th-selected="${game && game.data.gameSystem && game.data.gameSystem.select && game.data.gameSystem.select.system == system.name}"
                            data-th-each="system: ${gameSystems}" data-th-value="${system.name}"
                            data-th-text="${portal.localize({'_key=myGames.gameSystem.' + system.name, '_locale=ru'})}">
                        </option>
                    </div>
                    <div data-th-if="${block and block.data && block.data.system != null}" data-th-remove="tag">
                        <option selected data-th-value="${block.data.system}"
                            data-th-text="${portal.localize({'_key=myGames.gameSystem.' + block.data.system, '_locale=ru'})}">
                        </option>
                    </div>
                </select>
            </div>
            <input
                data-th-value="${game && game.data.gameSystem.text && game.data.gameSystem.text.system != '' && game.data.gameSystem._selected == 'text' ? game.data.gameSystem.text.system : '' }"
                data-th-placeholder="${portal.localize({'_key=myGames.form.gameSystem.placeholder', '_locale=ru'})}"
                type="text" name="systemInput" id="my_games_system-input"
                data-th-classappend="${game && game.data.gameSystem.text && game.data.gameSystem.text.system != '' && game.data.gameSystem._selected == 'text' ? '' : 'my_games-hidden-input'}"
                class="js-my_games-system-input my_games-system-input" data-ignore="true" />
        </div>
        <div class="form-group">
            <label for="my_games_virtual_table"
                data-th-text="${portal.localize({'_key=myGames.form.virtualTable', '_locale=ru'})}"></label>
            <div class="select-field">
                <select required name="virtualTable" id="my_games_virtual_table"
                    class="select js-my_games-select-with-other js-my_games-virtual-table">
                    <option data-th-text="${portal.localize({'_key=myGames.form.virtualTable.choose', '_locale=ru'})}"
                        disabled="disabled" selected>
                    </option>
                    <option
                        data-th-selected="${game && game.data.virtualTable && game.data.virtualTable.select.virtualTable == table.name}"
                        data-th-each="table: ${virtualTables}" data-th-value="${table.name}"
                        data-th-text="${portal.localize({'_key=myGames.virtualTable.' + table.name, '_locale=ru'})}">
                    </option>
                </select>
            </div>
            <input
                data-th-value="${game && game.data.virtualTable.text && game.data.virtualTable.text.virtualTable != '' && game.data.virtualTable._selected == 'text' ? game.data.virtualTable.text.virtualTable : ''}"
                data-th-placeholder="${portal.localize({'_key=myGames.form.virtualTable.placeholder', '_locale=ru'})}"
                type="text" name="tableInput" id="my_games_system-input"
                data-th-classappend="${game && game.data.virtualTable.text && game.data.virtualTable.text.virtualTable != '' && game.data.virtualTable._selected == 'text' ? '' : 'my_games-hidden-input'}"
                class="js-my_games-virtual-table-input my_games-system-input" data-ignore="true" />
        </div>
        <div class="form-group">
            <label for="my_games_theme"
                data-th-text="${portal.localize({'_key=myGames.form.theme', '_locale=ru'})}"></label>
            <div class="select-field">
                <select required name="theme" id="my_games_theme" class="select js-my_games-theme">
                    <option data-th-text="${portal.localize({'_key=myGames.form.theme.choose', '_locale=ru'})}"
                        disabled="disabled" selected>
                    </option>
                    <option data-th-selected="${game && game.data.theme == theme.name}" data-th-each="theme: ${themes}"
                        data-th-value="${theme.name}"
                        data-th-text="${portal.localize({'_key=myGames.theme.' + theme.name, '_locale=ru'})}">
                    </option>
                </select>
            </div>
        </div>
        <div class="form-group">
            <label for="my_games_adventure_name"
                data-th-text="${portal.localize({'_key=myGames.form.adventureName', '_locale=ru'})}"></label>
            <input data-th-value="${game != null ? game.displayName : (block.epic ? block.data.title : '') }"
                data-th-placeholder="${portal.localize({'_key=myGames.form.adventureName.placeholder', '_locale=ru'})}"
                type="text" name="displayName" required id="my_games_adventure_name" data-th-disabled="${block.epic}" />
            <div class="form-caption"
                data-th-text="${portal.localize({'_key=myGames.form.adventureName.caption', '_locale=ru'})}"></div>
        </div>
        <div class="form-group">
            <label for="my_games_adventure_description"
                data-th-text="${portal.localize({'_key=myGames.form.adventureDescription', '_locale=ru'})}"></label>
            <div class="tiny-mce-wrapper">
                <textarea required id="js_tiny-mce" type="text" name="description"
                    data-th-text="${game ? game.data.description : block.epic ? block.data.description : '' }"
                    minlength="100"
                    data-th-placeholder="${portal.localize({'_key=myGames.form.adventureDescription.placeholder', '_locale=ru'})}"></textarea>
            </div>
            <div class="form-caption"
                data-th-text="${portal.localize({'_key=myGames.form.adventureDescription.caption', '_locale=ru'})}">
            </div>
        </div>
        <div class="my_games-playears_qty-list form-group">
            <h5 class="form-group-title"
                data-th-text="${portal.localize({'_key=myGames.form.qtyOfPlayers', '_locale=ru'})}"></h5>
            <input data-th-attr="checked=${game && game.data.maxPlayers == 4}" required type="radio" name="maxPlayers"
                id="playears_qty_4" value="4" hidden>
            <label for="playears_qty_4" class="my_games-playears_qty-item active label-radio">
                <span>4</span>
            </label>

            <input data-th-attr="checked=${game && game.data.maxPlayers == 5}" required type="radio" name="maxPlayers"
                id="playears_qty_5" value="5" hidden>
            <label for="playears_qty_5" class="my_games-playears_qty-item label-radio">
                <span>5</span>
            </label>

            <input data-th-attr="checked=${game && game.data.maxPlayers == 6}" required type="radio" name="maxPlayers"
                id="playears_qty_6" value="6" hidden>
            <label for="playears_qty_6" class="my_games-playears_qty-item label-radio">
                <span>6</span>
            </label>
        </div>
        <div class="my_games-adventure_lang-list form-group">
            <h5 class="form-group-title"
                data-th-text="${portal.localize({'_key=myGames.form.adventureLang', '_locale=ru'})}"></h5>

            <input data-th-attr="checked=${game && game.data.language == 'ua'}" required type="radio" name="language"
                id="ukrainian" value="ua" hidden>
            <label for="ukrainian" class="my_games-adventure_lang-item active label-radio"
                data-th-text="${portal.localize({'_key=myGames.form.adventureLang.ua', '_locale=ru'})}">
            </label>

            <input data-th-attr="checked=${game && game.data.language == 'ru'}" required type="radio" name="language"
                id="russian" value="ru" hidden>
            <label for="russian" class="my_games-adventure_lang-item label-radio"
                data-th-text="${portal.localize({'_key=myGames.form.adventureLang.ru', '_locale=ru'})}">
            </label>

            <input data-th-attr="checked=${game && game.data.language == 'en'}" required type="radio" name="language"
                id="english" value="en" hidden>
            <label for="english" class="my_games-adventure_lang-item label-radio"
                data-th-text="${portal.localize({'_key=myGames.form.adventureLang.en', '_locale=ru'})}">
            </label>
        </div>
        <div class="form-group">
            <h5 class="form-group-title" data-th-text="${portal.localize({'_key=myGames.form.pregens', '_locale=ru'})}">
            </h5>

            <input data-th-attr="checked=${game && game.data.pregens == 'master'}" required type="radio" name="pregens"
                id="master" value="master" hidden>
            <label for="master" class="my_games-adventure_lang-item active label-radio"
                data-th-text="${portal.localize({'_key=myGames.form.pregens.master', '_locale=ru'})}">
            </label>

            <input data-th-attr="checked=${game && game.data.pregens == 'players'}" required type="radio" name="pregens"
                id="players" value="players" hidden>
            <label for="players" class="my_games-adventure_lang-item label-radio"
                data-th-text="${portal.localize({'_key=myGames.form.pregens.players', '_locale=ru'})}">
            </label>

            <input data-th-attr="checked=${game && game.data.pregens == 'playersAndMaster'}" required type="radio"
                name="pregens" id="playersAndMaster" value="playersAndMaster" hidden>
            <label for="playersAndMaster" class="my_games-adventure_lang-item label-radio"
                data-th-text="${portal.localize({'_key=myGames.form.pregens.playersAndMaster', '_locale=ru'})}">
            </label>
        </div>
        <div class="my_games-adventure_img form-group">
            <label class="my_games-adventure_img-label" for="game-img">
                <!-- <span class="my_games-adventure_img-text js_game-image-label">Добавить картинку</span> -->
                <div class="create_article-add_content js_game-image-label" data-th-unless="${game and game.image}">
                    <div class="create_article-add_content-inner">
                        <div class="create_article-add_content-btn">
                            <span class="create_article-add_content-icon">Добавить картинку</span>
                        </div>
                    </div>
                </div>
                <div class="my_games-adventure_img-img_wrap js_game-image"
                    data-th-classappend="${game and game.image} ? '' : 'hidden'">
                    <img alt="game picture" data-th-src="${game and game.image ? game.image.url : ''}">
                </div>
                <input type="file" id="game-img" class="js_image-upload" hidden data-ignore="true">
                <div class="form-caption"
                    data-th-text="${portal.localize({'_key=myGames.form.image.caption', '_locale=ru'})}"></div>
            </label>
            <input type="hidden" class="js_image-id" name="image"
                data-th-value="${game && game.data.image != null ? game.data.image : '' }">
        </div>
        <div class="my_games-additional form-group">
            <h5 class="form-group-title"
                data-th-text="${portal.localize({'_key=myGames.form.additional', '_locale=ru'})}"></h5>

            <input data-th-attr="checked=${game && game.data.explicit}" type="checkbox" name="explicit" id="explicit"
                hidden />
            <label for="explicit" class="label-checkbox"
                data-th-text="${portal.localize({'_key=myGames.form.additional.explicit', '_locale=ru'})}">
            </label>

            <input data-th-attr="checked=${game && game.data.kidsGame}" type="checkbox" name="kidsGame" id="kidsGame"
                hidden />
            <label for="kidsGame" class="label-checkbox"
                data-th-text="${portal.localize({'_key=myGames.form.additional.forChildren', '_locale=ru'})}">
            </label>

            <input data-th-attr="checked=${game && game.data.beginnerFriendly}" type="checkbox" name="beginnerFriendly"
                id="beginnerFriendly" hidden />
            <label for="beginnerFriendly" class="label-checkbox"
                data-th-text="${portal.localize({'_key=myGames.beginnerFriendly', '_locale=ru'})}">
            </label>
        </div>
        <div class="my_games-action-block">
            <button class="my_games-action-primary button js-my_games-step3-save"
                data-th-text="${portal.localize({'_key=myGames.save', '_locale=ru'})}"></button>
            <button class="my_games-action-secondary button js-my_games-step3-discard"
                data-th-text="${portal.localize({'_key=myGames.discard', '_locale=ru'})}"></button>
        </div>
        <input type="hidden" data-th-value="${location._id}" name="location" />
        <input type="hidden" data-th-value="${block._id}" name="blockId" />
        <input type="hidden" data-th-value="${action}" name="action" />
        <input data-th-if="${game && game._id}" type="hidden" data-th-value="${game._id}" name="_id" />
    </form>
</div>